# VKtask
Binary classification of time series
# Time Series Analysis, Feature Extraction and Time Series Classification with CatBoost
Этот проект предназначен для анализа временных рядов и извлечения признаков с использованием библиотек `pandas`, `numpy`, `statsmodels`, `matplotlib`, и `seaborn`. Данные загружаются из файла в формате Parquet и визуализируются для дальнейшего анализа. Этот проект показывает, как построить модель для классификации временных рядов, используя алгоритм `CatBoost`. Скрипт включает в себя все основные этапы: загрузку данных, предварительную обработку, обучение модели, оптимизацию гиперпараметров с помощью Optuna и создание файла для представления результатов.
## Описание
Проект загружает данные из `train.parquet`, удаляет ненужные столбцы, строит графики значений временных рядов, декомпозирует ряды, извлекает характеристики и сохраняет результаты в формате CSV для дальнейшего анализа. Проект использует методику градиентного бустинга для классификации и применяет различные алгоритмы для оценки производительности модели. Основное внимание уделяется CatBoost, который прекрасно работает с категориальными признаками и предоставляет результаты в интерпретируемом виде.
## Установка
Перед запуском убедитесь, что у вас установлены необходимые библиотеки. Вы можете установить их с помощью pip:
```bash
pip install pandas numpy seaborn matplotlib statsmodels scikit-learn catboost optuna

## Структура кода

1. Загрузка данных:
   - pd.read_parquet('train.parquet'): Загружает данные из файла формата Parquet.

2. Удаление ненужных столбцов:
   - Удаляется столбец id, который не используется для анализа.

3. Функции:
   - listToTimeLine(dates, values): Создает DataFrame из списков дат и значений.
   - iteratingTimeSeries(i, df): Извлекает данные временных рядов по заданному индексу.

4. Визуализация:
   - Графики временных рядов строятся с использованием matplotlib.
   - Визуализируются отношения между наблюдаемыми и сезонными компонентами.

5. Декомпозиция временных рядов:
   - Функция getDfComposed(df) выполняет декомпозицию временного ряда и сохраняет характеристики в новый DataFrame.

6. Извлечение признаков:
   - Извлекаются средние значения для различных компонент (наблюдаемое, сезонное, трендовое, остатки) и сохраняются в train_features.csv.

7. Обработка и визуализация характеристик:
   - Выполняются гистограммы и тепловые карты для визуализации связей между признаками.

8. TSNE Визуализация:
   - Используется метод t-SNE для визуализации высокоразмерных данных в двухмерном пространстве.

9. Загрузка библиотек:
   - Импортируются необходимые библиотеки для обработки данных, обучения моделей и визуализации.

10. Подготовка данных:
   - Данные разбиваются на обучающую и валидационную выборки.
   - Удаляются ненужные столбцы из тестового набора данных.

11. Оптимизация гиперпараметров:
   - Используется Optuna для поиска лучших значений параметров модели CatBoostClassifier.

12. Обучение модели:
   - Обучается классификатор CatBoost с использованием данных и рекомендаций по гиперпараметрам.

13. Оценка производительности:
   - Рассчитывается AUC ROC, строится ROC-кривая для визуализации результатов.

14. Кросс-валидация:
   - Выполняется кросс-валидация для проверки устойчивости модели.

15. Предсказания для тестового набора данных:
   - Применяются стандартные трансформации, и результаты сохраняются в файл submission.csv.

## Примечания
- Убедитесь, что ваши данные соответствуют ожиданиям этого скрипта.
- Обработка временных рядов может занять некоторое время в зависимости от объема данных.

## Контакты
VK: https://vk.com/b1stbeast
